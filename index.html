<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EZ Visual Code Editor</title>
    <!-- GitHub Pages-friendly CSP -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self' https:;
        script-src 'self' 'unsafe-inline' https:;
        style-src 'self' 'unsafe-inline' https:;
        img-src 'self' data: https:;
        font-src 'self' https:;
        connect-src 'self' https:;
        frame-src 'self' blob:;
        object-src 'none';
    ">
    <!-- Correct relative path for GitHub Pages -->
    <link rel="stylesheet" href="./ez_visual_editor_styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üé® EZ Visual Code Editor</h1>
            <p>No-code visual editing with direct manipulation</p>
        </header>

        <div class="main-layout">
            <!-- Code Input Panel -->
            <div class="panel">
                <div class="panel-header">
                    üìù HTML Code Input
                </div>
                <div class="panel-content">
                    <div class="controls">
                        <button class="btn btn-primary" onclick="analyzeCode()">
                            üîç Analyze & Preview
                        </button>
                        <button class="btn btn-warning" onclick="openVisualEditor()">
                            üé® Visual Edit
                        </button>
                        <button class="btn btn-secondary" onclick="clearCode()">
                            üóëÔ∏è Clear
                        </button>
                        <input type="file" id="fileInput" accept=".html" style="display: none;" onchange="loadFile(event)">
                        <button class="btn btn-secondary" onclick="document.getElementById('fileInput').click()">
                            üìÅ Load File
                        </button>
                        <button class="btn btn-success" onclick="saveCurrentCode()" id="saveCodeBtn" style="display: none;">
                            üíæ Save HTML
                        </button>
                    </div>
                    <textarea 
                        id="codeInput" 
                        class="code-input" 
                        placeholder="Paste your HTML code here or load a file..."
                    ></textarea>
                </div>
            </div>

            <!-- Preview Panel -->
            <div class="panel">
                <div class="panel-header">
                    üëÅÔ∏è Live Preview
                    <div>
                        <span id="tabIndicator" class="tab-indicator" style="display: none;">TAB SYSTEM</span>
                        <span id="effectIndicator" class="effect-indicator" style="display: none;">VISUAL EFFECTS</span>
                        <span id="interactiveIndicator" class="interactive-indicator" style="display: none;">INTERACTIVE</span>
                    </div>
                </div>
                <div class="panel-content">
                    <!-- GitHub-friendly iframe sandbox -->
                    <iframe 
                        id="previewFrame" 
                        class="preview-frame" 
                        sandbox="allow-same-origin allow-scripts allow-modals"
                    ></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- Visual Editor -->
    <div class="visual-editor" id="visualEditor">
        <div class="visual-editor-header">
            <h2>üé® Visual Editor - Click elements to edit</h2>
            <div>
                <button class="btn btn-success" onclick="saveFromVisualEditor()">
                    üíæ Save Changes
                </button>
                <button class="btn btn-secondary" onclick="closeVisualEditor()">
                    ‚ùå Exit Visual Mode
                </button>
            </div>
        </div>
        <div class="visual-editor-content">
            <iframe 
                id="visualEditorFrame" 
                class="visual-editor-frame" 
                sandbox="allow-same-origin allow-scripts allow-modals"
            ></iframe>
        </div>
    </div>

    <!-- Property Panel -->
    <div class="property-panel" id="propertyPanel">
        <div class="property-panel-header">
            <span id="selectedElementType">Element Properties</span>
        </div>
        <div class="property-panel-content" id="propertyPanelContent">
            <!-- Properties will be populated here -->
        </div>
    </div>

    <!-- Correct relative path for GitHub Pages -->
    <script src="./ez_visual_editor_app.js"></script>
</body>
</html>
